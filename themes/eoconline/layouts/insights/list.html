{{ define "main" }}
  {{ partial "page-header" . }}


  <section class="pt-2 section">
    <div class="container">
      <div class="row">
        <p class="mb-4 italic font-semibold">Insights are temporal notices, reviews and notes - that "expire"</p>
        <!-- insight (blog) posts -->
        <div class="lg:col-8">
          <div class="row">
            {{ $paginator:= .Paginate .RegularPages }}
            {{ range $paginator.Pages }}
              <div class="md:col-6 mb-14">
                {{ partial "components/insight-card" . }}
              </div>
            {{ end }}
          </div>
          {{ partial "components/pagination.html" . }}
        </div>

        <!-- sidebar -->
        <div class="lg:col-4">
          <!--
            Hugo Calendar widget:
            Â© www.github.com/eoc.online/hugo-calendar-widget
            'Insights' refer to 'blogs' or 'posts' in this context.
          -->

          <!-- execute of template failed: template: insights/list.html:26:70: executing "main" at <.URL>: can't evaluate field URL in type *hugolib.pageState      -->
          {{ $currentTaxonomy := index (last 1 (split (delimit (split .Permalink "/") "," "") ",")) 0 }}

          {{ $archive:= .Pages.GroupByDate "2006" }}
          {{ $initialPages := first 3 .Pages.ByPublishDate }}


          <p>First Article Date: {{ (index $initialPages 0).Date.Format "02 Jan 2006" }}</p>

          <hr />

          <ul>
            {{ range  $initialPages }}
              <li>
                <p>1st 4: <a href="{{ .Permalink }}">{{ .Title }}</a></p>
                <time>{{ .Date.Format "02 Jan 2006" }}</time>
              </li>
            {{ end }}
          </ul>

          <h3>init date: $initialPage.Date</h3>
          {{ $from := "2009" }}<!--$initialDate.Date.Format "2006" }}-->
          {{ $fromMonth := "1" }}
          <!--$initialDate.Date.Format "1" }}
          -->
          {{ partialCached "calendar" (dict "context" . "from" $from "fromMonth" $fromMonth "to" (now.Format "2006") "toMonth" (now.Format "1") "pages" .Site.Pages) }}


          <!-- widget wrapper
           $widget:= site.Params.widgets.sidebar }}
           partialCached "widgets/widget-wrapper" ( dict "Widgets" $widget "Scope" . ) }}
          -->
        </div>
      </div>
    </div>
  </section>
{{ end }}
