{{ $context := .context }}
{{ $from := int .from }}
{{ $fromMonth := int .fromMonth }}
{{ $to := int .to }}
{{ $toMonth := int .toMonth }}
{{ $pages := .pages }}


<!--
works:
  { site.Data | jsonify }}
  { printf "%#v" . }}

  {< myParam "yyyyyyyyy" >}}  -- only works in MD files!

  HUGO.toml:
    [[Params.skin]]
		  show_generated_by = true

   partials/footer.html:
    { if .Site.Params.skin.show_generated_by }}  - I think Params is depricated, so remove that one word...

  { $myParams := .Params }}

is true:
{ strings.Contains ( . | jsonify) "yyyy" }}

yy =
{ .Site.yyyyyyyyy }}
.Site.Author2.name =
{ .Site.author2.name }}
params.author2.name = { .params.author2.name }} -
{ .Params.author2.name }}
  -->

<!--
  Calendar to call year with From:
  {$from }}-{ $fromMonth }}
  To: { $to }}-{ $toMonth }} <br />

  # of pages =
  { (len .pages) }}
-->

{{ $context.Scratch.Set "currentYear" $from }}
{{ $context.Scratch.Add "consideredYears" (slice $from) }}

{{ range ($pages.GroupByPublishDate "2006") }}
  {{ $context.Scratch.SetInMap "ArticlesPerYear" .Key ((len .Pages)) }}
{{ end }}

{{ range ($pages.GroupByPublishDate "2006-01") }}
  {{ $context.Scratch.SetInMap "ArticlesPerMonth" .Key (len .Pages) }}
{{ end }}

{{ range ($pages.GroupByPublishDate "2006-01-02") }}
  {{ $context.Scratch.SetInMap "ArticlesPerDay" .Key (len .Pages) }}
{{ end }}

{{ range $i, $sequence := (seq ((sub $to $from))) }}
  {{ $currentYear := $context.Scratch.Get "currentYear" }}
  {{ $nextYear := (add $from $sequence) }}

  {{ if le $nextYear $to }}
    {{ $context.Scratch.Add "consideredYears" ($nextYear) }}
    <!-- had been: $context.Scratch.Add "consideredYears" (slice $nextYear) }} -->
    {{ $context.Scratch.Set "currentYear" $nextYear }}
    <!-- br />Adding consideredYears: slice { $nextYear }}<br /-->
  {{ end }}

{{ end }}

{{ range ($context.Scratch.Get "consideredYears") }}
  <!--
      <br />Calendar calling year '{ . }}' with From: { $from }}-{ $fromMonth }} To: { $to }}-{ $toMonth }}<br />
    -->
  {{ partialCached "calendar/year" (dict "context" $context "year" . "from" $from "fromMonth" $fromMonth "to" $to
    "toMonth" $toMonth) (string (delimit (slice $from $fromMonth $to $toMonth .) ""))
  }}
{{ end }}


<script>
  // from https://tailwindcomponents.com/component/faq-1
  let elements = document.querySelectorAll("[toggle-item]");
  for (let i = 0; i < elements.length; i++) {
    let main = elements[i];

    main.addEventListener("click", function () {
      let element = main.parentElement.parentElement;
      let indicators = main.querySelectorAll("img");
      //let child = element.querySelector("#menu");

      // let h = element.querySelector("#mainHeading>header>h5");
      let classes = element.querySelector("#mainHeading>button>header>span").classList;
      let imageClasses = element.querySelector("#mainHeading>button>header>span>img").classList;

      //console.log("Classes (before) =" + classes);
      console.log("Classes (before) =" + imageClasses);

      if (classes.contains("close-folder")) {
        console.log("Opening folder");
        classes.add("open-folder");
        classes.remove("close-folder");
        imageClasses.add("open-folder-img");
        imageClasses.remove("close-folder-img");
      } else {
        console.log("Closing folder");
        classes.add("close-folder");
        classes.remove("open-folder");
        imageClasses.add("close-folder-img");
        imageClasses.remove("open-folder-img");
      }
      // const classes = h.classList;
      // for (let cssClass of classes) {
      //   console.log(cssClass + "; ");
      // }

      //console.log("clicked!");
      //<!-- .Pages | jsonify }} -->

      //classes.toggle("font-semibold");
      //classes.toggle("open-folder");
      //h.classList.toggle("myStyle");
      //h.classList.toggle("hidden");
      //for (let klass in child.classlist) {
      //  console.log(klass.toString());
      //}
      //console.log("child:" + child);

      //console.log("### indicators:" + indicators[0]);
      //indicators[0].classList.toggle("src" == "/images/minus-1.svg" ? "/images/arrow-up.svg" : "/images/plus-1.svg");
      //indicators[0].classList.toggle("myStyle", "hidden");

      //indicators[0].classList.toggle("rotate-180");
      //object.style.rotate = "-120deg";
      // add or remove multiple classes
      //div.classList.add("foo", "bar", "baz");
      //div.classList.remove("foo", "bar", "baz");

      //console.log("Classes (after) =" + classes);
      console.log("Classes (after) =" + imageClasses);
    });
  }
</script>
